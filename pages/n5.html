<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh sách Kanji N5 - 14 Bài học</title>
    <link rel="stylesheet" href="../css/font.css">
    <style>
        :root { 
            --primary-orange: #f1b34c; 
            --bg: #f0f2f5; 
            --text-main: #2c3e50; 
            --text-sub: #95a5a6; 
        }
        body { 
            font-family: 'Quicksand', sans-serif; 
            background: var(--bg); 
            margin: 0; padding: 20px; 
            color: var(--text-main); 
        }
        .container { max-width: 900px; margin: 0 auto; }
        
        .back-nav { 
            margin-bottom: 20px; 
            text-decoration: none; 
            color: var(--text-sub); 
            display: inline-block; 
            font-size: 0.9rem; 
            font-weight: 600;
        }

        .lesson-card { 
            background: white; 
            border-radius: 30px; 
            padding: 25px; 
            margin-bottom: 25px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.03); 
        }
        .lesson-header { 
            border-left: 5px solid var(--primary-orange); 
            padding-left: 15px; 
            margin-bottom: 20px; 
        }
        .lesson-header h2 { margin: 0; font-size: 1.4rem; }
        .lesson-header p { margin: 5px 0 0; color: var(--text-sub); font-size: 0.85rem; }

        .kanji-grid { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 12px; 
            margin-bottom: 20px; 
        }

        .kanji-box { 
            background: white; 
            border: 1px solid #edf2f7; 
            border-radius: 15px; 
            width: 65px; 
            padding: 12px 5px; 
            text-align: center; 
            text-decoration: none; 
            color: inherit; 
            transition: all 0.2s ease; 
        }
        .kanji-box:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); 
            border-color: var(--primary-orange);
        }
        .kanji-char { 
            font-size: 1.5rem; 
            font-weight: 700; 
            display: block; 
            margin-bottom: 8px; 
        }

        .mini-p-container { 
            width: 80%; 
            height: 6px; 
            background: #eee; 
            border-radius: 10px; 
            margin: 0 auto; 
            overflow: hidden; 
        }
        .mini-p-bar { 
            height: 100%; 
            background: var(--primary-orange); 
            transition: width 0.4s ease; 
            width: 0%;
        }

        .btn-review { 
            background: var(--primary-orange); 
            color: white; 
            border: none; 
            padding: 10px 22px; 
            border-radius: 15px; 
            font-weight: 700; 
            cursor: pointer; 
            float: right; 
            text-decoration: none; 
            font-size: 0.9rem; 
        }
        .clearfix::after { content: ""; clear: both; display: table; }
    </style>
</head>
<body>

    <div class="container">
        <a href="../index.html" class="back-nav">← Quay lại danh sách cấp độ</a>
        <div id="lesson-list"></div>
    </div>

<script>
    const lessons = {
        "1": { title: "Yếu tố tự nhiên", chars: ['日', '月', '金', '水', '火', '木', '土'] },
        "2": { title: "Thiên nhiên & Thời tiết", chars: ['車', '門', '田', '山', '川', '雨', '天', '気'] },
        "3": { title: "Gia đình & Bản thân", chars: ['父', '母', '私', '兄', '姉', '弟', '妹'] },
        "4": { title: "Số đếm cơ bản", chars: ['一', '二', '三', '四', '五', '六', '七', '八', '九', '十'] },
        "5": { title: "Thời gian & Đơn vị", chars: ['百', '千', '万', '円', '年', '半', '分', '時'] },
        "6": { title: "Con người & Trường học", chars: ['人', '女', '生', '子', '学', '先', '白'] },
        "7": { title: "Bộ phận cơ thể", chars: ['口', '石', '手', '足', '耳', '目', '体'] },
        "8": { title: "Ký hiệu & Kích thước", chars: ['上', '下', '中', '大', '小', '本', '力', '何', '出', '入'] },
        "9": { title: "Kết hợp ý nghĩa", chars: ['明', '休', '好', '男', '間', '岩', '畑', '森', '林'] },
        "10": { title: "Phương hướng", chars: ['右', '左', '東', '西', '北', '南', '外', '駅', '会', '内'] },
        "11": { title: "Tính từ cơ bản", chars: ['長', '高', '名'] },
        "12": { title: "Động từ hành động", chars: ['行', '来', '食', '見', '聞', '読', '書', '話'] },
        "13": { title: "Trạng thái thời gian", chars: ['午', '前', '後', '毎'] },
        "14": { title: "Thông dụng khác", chars: ['校', '語', '今', '電', '国'] }
    };

    function renderLessons() {
        const list = document.getElementById('lesson-list');
        list.innerHTML = ''; 

        Object.keys(lessons).forEach(id => {
            const lesson = lessons[id];
            let charsHtml = '';

            lesson.chars.forEach(char => {
                const count = parseInt(localStorage.getItem(`count_${char}`) || 0);
                const percent = Math.min(count * 20, 100);

                charsHtml += `
                    <a href="detail.html?k=${encodeURIComponent(char)}" class="kanji-box">
                        <span class="kanji-char">${char}</span>
                        <div class="mini-p-container">
                            <div class="mini-p-bar" style="width: ${percent}%"></div>
                        </div>
                    </a>`;
            });

            list.innerHTML += `
                <div class="lesson-card">
                    <div class="lesson-header">
                        <h2>Bài ${id}</h2>
                        <p>${lesson.title}</p>
                    </div>
                    <div class="kanji-grid">${charsHtml}</div>
                    <div class="clearfix">
                        <a href="review.html?lesson=${id}" class="btn-review">Ôn tập bài ${id}</a>
                    </div>
                </div>`;
        });
    }

    // Sử dụng pageshow để cập nhật ngay khi nhấn nút "Xong" từ writing.html quay lại
    window.addEventListener('pageshow', renderLessons);
</script>
</body>
</html>